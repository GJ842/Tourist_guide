<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tourist Guide Main</title>
    <style>
        body {
            object-fit: fill;
            background-repeat: no-repeat;
            background-attachment: fixed;
            margin: 0;
            font-family: cursive, Arial, Helvetica, sans-serif;
        }

        .topnav {
            overflow: hidden;
            background-color: #333;
        }

        .topnav a {
            float: left;
            color: #f2f2f2;
            text-align: center;
            vertical-align: top;
            padding: 14px 16px;
            text-decoration: none;
            font-size: 17px;
        }

        .topnav a:hover {
            background-color: #ddd;
            color: black;
        }

        div.topnav a.active {
            background-color: #04AA6D;
            color: white;
        }

        .right {
            margin-left: 880px;
            transition: 0.4s;
        }

        td {
            text-align: center;
            border: gray solid 1px;
        }

        th {
            text-align: center;
            border: black solid 2px;
        }

        .add,#fpbtn{
            margin: 8px auto 10px auto;
            padding: 6px 20px;
            border-radius: 5px;
            background: black;
            color: white;
            transition: 0.5s;
            box-shadow: 2px 2px gray;
        }

        .add:hover,#fpbtn:hover {
            color: black;
            background: white;
        }

        .add:active,#fpbtn:active {
            box-shadow: -2px -2px gray;
            transition: 0.1s;
        }
    </style>
</head>

<body>
    <div>
        <div>
            <div class="navbar">
                <div class="topnav">
                    <a class="active" href="#Tourist Guide">Tourist Guide</a>
                    <a class="right" href="sign_in_page_nocom.html">Log Out</a>
                </div>
            </div>
            <div>
                <table style="border: grey solid 1px;">
                    <form>
                        <tr>
                            <th style="width:50%;">City Name</th>
                            <th style="width:12%;">Tourist Spot</th>
                            <th style="width:8%;">Total number of people (max 20)</th>
                            <th style="width:12%;">Date</th>
                            <th style="width:12%;">Class</th>
                            <th style="width:5%">Age(&lt;5)</th>
                            <th style="width:5%;">Additions</th>
                        </tr>
                        <tr>
                            <td rowspan="3"><img src="Bangalore.jpg" style="width: 70%;">
                            </td>
                            <td id="dest1">Bangalore Pallace (Rs 500)</td>
                            <td><input type="number" max="20" min="1" style="width:90%" id="peo1"></td>
                            <td><input type="date" id="date1" class="date"></td>
                            <td><select name="class1" id="class1">
                                    <option value="economy">Economy</option>
                                    <option value="luxury">Luxury</option>
                                </select></td>
                            <td><input type="number" style="width:80%;" id="less51"></td>
                            <td><input type="button" value="Add" id="add1" class="add" onclick="addclk()"></td>
                        </tr>
                        <tr>
                            <td id="dest2">Cubbon Park (Rs 600)</td>
                            <td><input type="number" max="20" min="1" style="width:90%" id="peo2" value=""></td>
                            <td><input type="date" id="date2" class="date"></td>
                            <td><select name="class2" id="class2">
                                    <option value="economy">Economy</option>
                                    <option value="luxury">Luxury</option>
                                </select></td>
                            <td><input type="number" style="width:80%;"></td>
                            <td><input type="button" value="Add" id="add2" class="add" onclick="addclk()"></td>
                        </tr>
                        <tr>
                            <td id="dest3">Nandi Hills (Rs 800)</td>
                            <td><input type="number" max="20" min="1" style="width:90%" id="peo3" value=""></td>
                            <td><input type="date" id="date3"></td>
                            <td><select name="class3" id="class3">
                                    <option value="economy">Economy</option>
                                    <option value="luxury">Luxury</option>
                                </select></td>
                            <td><input type="number" style="width:80%;"></td>
                            <td><input type="button" value="Add" id="add3" class="add" onclick="addclk()"></td>
                        </tr>
                        <tr>
                            <td rowspan="2"><img src="Mumbai.jpg" style="width: 70%;"></td>
                            <td id="dest4">Elephanta Caves (Rs 1000)</td>
                            <td><input type="number" max="20" min="1" style="width:90%" id="peo4" value=""></td>
                            <td><input type="date" id="date4"></td>
                            <td><select name="class4" id="class4">
                                    <option value="economy">Economy</option>
                                    <option value="luxury">Luxury</option>
                                </select></td>
                            <td><input type="number" style="width:80%;"></td>
                            <td><input type="button" value="Add" id="add4" class="add" onclick="addclk()"></td>
                        </tr>
                        <tr>
                            <td id="dest5">Kandheri Caves (Rs 1200)</td>
                            <td><input type="number" max="20" min="1" style="width:90%" id="peo5" value=""></td>
                            <td><input type="date" id="date5"></td>
                            <td><select name="class5" id="class5">
                                    <option value="economy">Economy</option>
                                    <option value="luxury">Luxury</option>
                                </select></td>
                            <td><input type="number" style="width:80%;"></td>
                            <td><input type="button" value="Add" id="add5" class="add" onclick="addclk()"></td>
                        </tr>
                </table>
            </div>
            <div>
                <h2>For childern below age 5, the fare is absolutely free!!!<br>
                    For Luxury Class, the price will be 300 more...</h2>
            </div>
            
            <div>
                <h1>Cart:</h1><br>
                <div id="receipt1">
                <table id="checkout">
                    <tr>
                        <th>Location</th>
                        <th>Number of people</th>
                        <th>Date</th>
                        <th>Class</th>
                        <th>Price</th>
                    </tr>
                </table>
                </div>
            </div>
            <div><input type="button" value="Generate Price" id="fpbtn"></div><br><br>
            
            <div id="final">
            </div>
            
            
        </div>
    </div>
    <script>
        let table = document.querySelector("#checkout")

        function datechk(getDate) {
            var curdate = new Date();
            var getDaten = new Date(getDate);
            if (getDaten >= curdate) {
                return true;
            }
            else {
                return false
            }
        }

        function addclk(click) {
            var addn = event.currentTarget;
            var parent = addn.parentElement.closest('tr');

            if (parent.childElementCount - 1 == 5) {
                var touristspot = parent.children[0].innerHTML;
                console.log(touristspot);
                var noofpeep = parent.children[1].children[0].value;
                console.log(noofpeep);
                var getDate = parent.children[2].children[0].value;
                console.log(getDate);
                var getclass = parent.children[3].children[0].value;
                console.log(getclass);
                var getage5 = parent.children[4].children[0].value;
                console.log(getage5);
            }
            else {
                var touristspot = parent.children[1].innerHTML;
                console.log(touristspot);
                var noofpeep = parent.children[2].children[0].value;
                console.log(noofpeep);
                var getDate = parent.children[3].children[0].value;
                console.log(getDate);
                var getclass = parent.children[4].children[0].value;
                console.log(getclass);
                var getage5 = parent.children[5].children[0].value;
                console.log(getage5);
            }



            if (parseInt(noofpeep) <= parseInt(getage5) || datechk(getDate) == false) {
                console.log(noofpeep);
                console.log(getage5);
                console.log(noofpeep <= getage5);
                console.log(datechk(getDate)==false);
                alert("Please Enter Valid Values");
            }
            else {

                noofpeep -= getage5;
                var getfprice = parseInt(touristspot.substring(touristspot.length - 5, touristspot.length - 1));
                if (getclass == 'luxury') {
                    getfprice += 300;
                }
                getfprice *= noofpeep;

                let template = `
            <tr>
                <td>${touristspot}</td>
                <td>${noofpeep}</td>
                <td>${getDate}</td>
                <td>${getclass}</td>
                <td>${getfprice}</td>
            </tr>`;

                table.innerHTML += template
            }
        }

        fpbtn.addEventListener("click", () => {
            var sumVal = 0;
            final = document.getElementById("final");
            final.innerHTML = "";
            console.log(final)
            for (var i = 1; i < table.rows.length; i++) {
                sumVal = sumVal + parseInt(table.rows[i].cells[4].innerHTML);
            }
            temp = `
            <h2> Final Price Equals: ${sumVal}</h2><br><br>
            <input type="button" onclick="printDiv()" value="Print"><br>
            <br>
            `
            final.innerHTML += temp;
        })


        function printDiv() {
            var divContents1 = document.getElementById("receipt1").innerHTML;
            var divContents2 = document.getElementById("final").innerHTML;
            var a = window.open('', '', 'height=500, width=500');
            a.document.write('<html>');
            a.document.write('<body ><h1>RECEIPT</h1><br>');
            a.document.write(divContents1);
            a.document.write(divContents2);
            a.document.write('</body></html>');
            a.document.close();
            a.print();
        }
    </script>
</body>
</html>